<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Psicol√≥gico TPT</title>
    <!-- Importamos Chart.js para los gr√°ficos -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
    <style>
        /* Reset b√°sico de CSS */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        /* Estilos generales del cuerpo */
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            padding: 20px;
            background-color: #f0f2f5;
        }

        /* Contenedor principal */
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            min-height: 500px;
        }

        /* P√°ginas del test */
        .intro-page,
        .question-page,
        .results-page {
            padding: 20px;
        }

        .intro-page {
            text-align: center;
        }

        .question-page,
        .results-page {
            display: none;
            /* Ocultas por defecto */
        }

        /* Encabezados y textos */
        h1 {
            text-align: center;
            margin-bottom: 20px;
            color: #1a365d;
        }

        h2 {
            text-align: center;
            margin-bottom: 20px;
            color: #000000;
        }

        .instructions {
            text-align: left;
            margin: 20px auto;
            padding: 20px;
            background-color: #f8fafc;
            border-radius: 8px;
            max-width: 600px;
        }

        /* Elementos de las preguntas */
        .question-number {
            font-size: 1.2em;
            color: #4a5568;
            margin-bottom: 10px;
        }

        .question-text {
            font-size: 1.3em;
            margin-bottom: 30px;
            line-height: 1.4;
            font-weight: 600;
            /* A√±adido para hacer el texto en negrita */
        }

        /* Contenedor de opciones */
        .options-container {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        /* Botones de opci√≥n */
        .option-button {
            padding: 15px 20px;
            font-size: 1.1em;
            background-color: #edf2f7;
            border: 2px solid #cbd5e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .option-button:hover {
            background-color: #e2e8f0;
            transform: translateY(-2px);
        }

        .option-button.selected {
            background-color: #4299e1;
            color: white;
            border-color: #2b6cb0;
        }

        /* Botones de navegaci√≥n */
        .start-button,
        .next-button {
            display: block;
            width: 200px;
            margin: 20px auto;
            padding: 12px 24px;
            font-size: 1.2em;
            background: linear-gradient(90deg, #3B82F6 0%, #1E40AF 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .next-button:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
        }

        .start-button:hover,
        .next-button:hover:not(:disabled) {
            background: linear-gradient(90deg, #2563EB 0%, #1E3A8A 100%);
            transform: translateY(-2px);
        }

        /* Barra de progreso */
        .progress-bar {
            width: 100%;
            height: 10px;
            background-color: #e2e8f0;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3B82F6 0%, #1E40AF 100%);
            /* Mismo gradiente */
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Contenedor de gr√°ficos */
        .chart-container {
            margin: 20px 0;
            height: 600px;
            position: relative;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        /* Estilos para los resultados */
        .scale-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .scale-name {
            font-size: 1.2em;
            font-weight: bold;
            color: #2d3748;
        }

        .scale-details {
            background-color: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .score-info {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 15px;
        }

        .items-info {
            margin: 15px 0;
            font-size: 0.9em;
        }

        /* Barra de percentil */
        .percentil-bar {
            width: 100%;
            height: 20px;
            background-color: #e2e8f0;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }

        .percentil-fill {
            height: 100%;
            background: linear-gradient(90deg, #4299e1 0%, #48bb78 100%);
            transition: width 0.5s ease;
        }

        /* Items de resultado */
        .result-item {
            border: 1px solid #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        /* Badges de estado */
        .status-badge {
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: bold;
        }

        .status-badge.apt {
            background-color: #c6f6d5;
            color: #22543d;
        }

        .status-badge.not-apt {
            background-color: #fed7d7;
            color: #742a2a;
        }

        /* Estilos para la tabla de respuestas */
        #answersTable table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        #answersTable th,
        #answersTable td {
            border: 1px solid #e2e8f0;
            padding: 12px;
            text-align: left;
        }

        #answersTable th {
            background-color: #f8fafc;
            font-weight: bold;
        }

        #answersTable tr:nth-child(even) {
            background-color: #f8fafc;
        }

        .scale-selector {
            padding: 20px;
            text-align: center;
        }

        .scales-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 15px;
            padding: 20px;
        }

        .scale-button {
            background-color: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            font-weight: bold;
        }

        .scale-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-color: #3B82F6;
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- P√°gina de introducci√≥n -->
        <div id="introPage" class="intro-page">
            <h1>JOSE ACADEMY ü§ñ</h1>
            <h2>Test Psicol√≥gico TPT</h2>
            <div class="instructions">
                <h3>Instrucciones</h3>
                <p>Conteste una de las siguientes letras para indicar que esa forma de actuar es propia de usted:</p>
                <ul>
                    <li><strong>A.</strong> casi nunca</li>
                    <li><strong>B.</strong> a veces</li>
                    <li><strong>C.</strong> con frecuencia</li>
                    <li><strong>D.</strong> casi siempre</li>
                </ul>
            </div>
            <button class="start-button" onclick="startTest()">Comenzar Test üéØ</button>
            <button class="start-button" onclick="startTrainingMode()">Modo Entrenamiento üí™</button>
        </div>

        <!-- P√°gina de preguntas -->
        <div id="questionPage" class="question-page">
            <h2>JOSE ACADEMY ü§ñ</h2>
            <div class="progress-bar">
                <div id="progressFill" class="progress-fill"></div>
            </div>
            <div class="question-number" id="questionNumber"></div>
            <div class="question-text" id="questionText"></div>
            <div class="options-container">
                <button class="option-button" onclick="selectOption('A')">A. casi nunca</button>
                <button class="option-button" onclick="selectOption('B')">B. a veces</button>
                <button class="option-button" onclick="selectOption('C')">C. con frecuencia</button>
                <button class="option-button" onclick="selectOption('D')">D. casi siempre</button>
            </div>
            <button class="next-button" onclick="nextQuestion()" disabled>Siguiente</button>
        </div>


        <!-- P√°gina de resultados -->
        <div id="resultsPage" class="results-page">
            <div id="resultsContainer"></div>
        </div>
        <div id="trainingPage" class="question-page" style="display:none">
            <h2>JOSE ACADEMY ü§ñ</h2>
            <h3>Modo Entrenamiento - Test TPT üí™</h3>
            <div id="scaleSelector" class="scale-selector">
                <h4>Selecciona una escala para practicar:</h4>
                <div class="scales-grid">
                    <button class="scale-button" onclick="selectTrainingScale('sinceridad')">üß≠ Sinceridad</button>
                    <button class="scale-button" onclick="selectTrainingScale('ansiedad')">üò∞ Ansiedad</button>
                    <button class="scale-button" onclick="selectTrainingScale('depresion')">üåßÔ∏è Depresi√≥n</button>
                    <button class="scale-button" onclick="selectTrainingScale('toleranciaFlexibilidad')">üåÄ Tolerancia
                        Flexibilidad</button>
                    <button class="scale-button" onclick="selectTrainingScale('toleranciaEstres')">üî• Tolerancia al
                        Estr√©s</button>
                    <button class="scale-button" onclick="selectTrainingScale('autoConcepto')">ü™û Auto Concepto</button>
                    <button class="scale-button" onclick="selectTrainingScale('adaptacionCambio')">üîÑ Adaptaci√≥n al
                        Cambio</button>
                    <button class="scale-button" onclick="selectTrainingScale('disponibilidad')">üìû
                        Disponibilidad</button>
                    <button class="scale-button" onclick="selectTrainingScale('integracionSocial')">ü§ù Integraci√≥n
                        Social</button>
                    <button class="scale-button" onclick="selectTrainingScale('tesonConstancia')">üèãÔ∏è‚Äç‚ôÇÔ∏è Tes√≥n /
                        Constancia</button>
                    <button class="scale-button" onclick="selectTrainingScale('trabajoEquipo')">üë• Trabajo en
                        Equipo</button>
                    <button class="scale-button" onclick="selectTrainingScale('desajuste')">üß® Desajuste</button>

                </div>
            </div>

            <div id="trainingQuestionPage" style="display:none">
                <div class="progress-bar">
                    <div id="trainingProgressFill" class="progress-fill"></div>
                </div>
                <div id="trainingQuestionNumber" class="question-number"></div>
                <div id="trainingQuestionText" class="question-text"></div>
                <div class="options-container" id="trainingOptionsContainer"></div>
                <button class="next-button" id="trainingNextButton" onclick="nextTrainingQuestion()"
                    disabled>Siguiente</button>
                <button class="next-button" onclick="backToScaleSelection()">Cambiar Escala</button>
            </div>

            <div id="trainingResultsPage" style="display:none">
                <h3>Resultados del Entrenamiento</h3>
                <div id="trainingResultsContainer"></div>
                <button class="next-button" onclick="backToScaleSelection()">Practicar Otra Escala</button>
            </div>
        </div>
        <script>
            // Array de preguntas del test
            const questions = [
                "Cuando algo no se resuelve no me siento mal e insisto hasta encontrar una soluci√≥n.",
                "Me siento vulnerable a las cr√≠ticas de los dem√°s.",
                "Si se diera el caso, acudir√≠a sin reparos a una manifestaci√≥n contra el racismo.",
                "Cuando no me apetece hacer una cosa, cualquier excusa me sirve.",
                "Me molestan cierto tipo de pensamientos extra√±os.",
                "Me molesta que la vida est√© cambiando tan r√°pidamente.",
                "Al irme a dormir suele haber alg√∫n pensamiento que me preocupa.",
                "Me aburren los documentales sobre otras culturas.",
                "Soy capaz de conseguir que los dem√°s cambien de opini√≥n.",
                "Me gusta m√°s empezar cosas nuevas que llevarlas a cabo.",
                "Me atraen la vida y costumbres de otros pueblos.",
                "Me da igual que todo el mundo sepa que he fallado en mi trabajo.",
                "Si la hora de salida prevista de un viaje se retrasa por motivos ajenos a m√≠, me lo tomo con tranquilidad y paciencia.",
                "Si me llegan varios problemas a la vez me siento mal y no s√© qu√© hacer.",
                "En mi entorno familiar o social se habla mal de m√≠.",
                "Me siento inferior cuando hablo con una persona de mayor rango o nivel que yo.",
                "Mantengo la confianza en m√≠ cuando las cosas se ponen dif√≠ciles.",
                "Acepto sin rechistar las √≥rdenes que provienen de mis superiores.",
                "Me empe√±o al m√°ximo en conseguir lo que me propongo.",
                "En mi vida est√°n ausentes esas experiencias extra√±as que tienen algunas personas.",
                "Soy estricto con mi horario laboral para poder disfrutar de mi familia y amigos.",
                "Evito los an√°lisis m√©dicos rutinarios por si me encuentran algo.",
                "Cuando trabajo en equipo, si no se me hace caso me enfado considerablemente.",
                "Si veo a alguien en apuros hago todo lo posible por ayudarle.",
                "Me f√≠o poco de los otros.",
                "S√© c√≥mo tratar a la gente.",
                "Suelo estar muy fatigado al acabar la jornada laboral.",
                "Me molesta no poder terminar algo que he empezado.",
                "Cuando no s√© hacer algo busco la ayuda de un compa√±ero.",
                "Me cuesta congeniar con alguien a quien constantemente le asaltan las dudas y no es capaz de tomar una decisi√≥n r√°pida.",
                "Cuando me incorporo a una reuni√≥n me intereso por la conversaci√≥n y trato de participar en ella.",
                "Prefiero trabajar lentamente y sin presi√≥n.",
                "Todo lo nuevo me encanta.",
                "Cuando he trabajado en equipo he procurado compartir mis puntos de vista.",
                "En una reuni√≥n prefiero que sean los dem√°s quienes hablen.",
                "Uno de mis lemas es: 'Piensa mal y acertar√°s'.",
                "Mis sue√±os suelen tener un tono relajante o amable.",
                "Si se produce una situaci√≥n de emergencia, mantengo la calma y la serenidad.",
                "Cuando me enfado puedo ser muy desagradable.",
                "Me molesta mucho faltar al trabajo cuando estoy enfermo.",
                "Me molesta que surjan imprevistos que hagan cambiar mis planes.",
                "Si lo que hago me llega a producir tensi√≥n me pongo a hacer otra cosa.",
                "Hay √©pocas en que, sin raz√≥n aparente, me siento m√°s animado que de costumbre.",
                "Cuando voy al cine u otro espect√°culo no soporto tener que esperar en la cola.",
                "Cuando me comprometo a algo, hago todo lo posible por cumplirlo.",
                "Los fracasos reiterados me dejan desanimado.",
                "Las emociones forman parte de mi comportamiento normal.",
                "Evito asumir m√°s trabajo hasta que termino lo que tengo entre manos.",
                "Me produce cierta envidia ver triunfar a alguien similar a m√≠.",
                "Cuando veo un accidente me siento mal y me alejo.",
                "Por las ma√±anas me levanto lleno de energ√≠a y vitalidad.",
                "Me resulta dif√≠cil marcarme objetivos ambiciosos y conseguirlos.",
                "Si no congenio con alguien la primera vez que lo veo pienso que otro d√≠a podr√≠a ir mejor.",
                "Vivo tranquilo ante lo que pueda pasar en el futuro.",
                "Me gustan los retos nuevos porque estimulan mi iniciativa.",
                "Critico a las personas informales o incumplidoras.",
                "Me gusta gozar del afecto de todo el mundo.",
                "Me cuesta trabajar muchas horas seguidas; necesito descansar de vez en cuando.",
                "Cuando me desplazo al trabajo o a otro lugar muy conocido para m√≠, me gusta hacer el mismo recorrido cada d√≠a.",
                "En los trabajos de grupo me implico como el que m√°s.",
                "Cuando las cosas van mal suelo darme por vencido.",
                "Tengo un humor bastante estable.",
                "Si tengo que ayudar a los dem√°s, abandono lo que est√© haciendo en ese momento.",
                "Prefiero fijarme metas poco ambiciosas para estar seguro de alcanzarlas.",
                "Soy comprensivo con otras religiones aunque no las comparta ni las practique.",
                "He dejado de hacer alguna cosa por falta de confianza en m√≠ mismo.",
                "Estoy dispuesto a ayudar a los nuevos compa√±eros que empiezan a trabajar.",
                "Soy tajante cuando tomo una decisi√≥n y no contemplo cambiar de opini√≥n.",
                "Cuando empiezo algo lo tengo que terminar, aunque me cueste m√°s de lo previsto.",
                "Cuando hago una reclamaci√≥n salgo victorioso sin tener que subir de tono mi discurso.",
                "Si estoy a gusto en mi trabajo el salario me importa muy poco.",
                "Cuando algo me interesa, me dedico a ello sin sentir fatiga.",
                "Si se me amontonan los problemas, me falla la confianza en m√≠ mismo.",
                "Me resulta f√°cil hablar con personas que no conozco de nada.",
                "√öltimamente tengo momentos malos o de inquietud.",
                "Me desagrada la gente que llega tarde a una cita y se excusa con cualquier motivo.",
                "Creo que las dificultades me han ayudado a superarme y a desarrollarme.",
                "Creo que soy competente y eficaz en mi trabajo.",
                "Evito verme envuelto en situaciones de constante cambio.",
                "Creo que la mejor forma de descanso es cambiar de actividad.",
                "Me interesan las culturas diferentes a la m√≠a.",
                "Prefiero dejar a otros la direcci√≥n de las actividades de grupo.",
                "Me comporto de acuerdo a las normas sociales establecidas.",
                "Me cuesta terminar las tareas mon√≥tonas y aburridas.",
                "Intento estar localizable y disponible.",
                "Me resulta dif√≠cil entablar amistad con una persona extranjera.",
                "Suelo mantener la sonrisa y la calma cuando me enfado por algo o con alguien.",
                "Me gusta probar la comida de otros pa√≠ses.",
                "Me gusta discutir y enfrentarme a los dem√°s.",
                "Yo soy mi mejor consejero.",
                "En mi trabajo soy una persona met√≥dica y sistem√°tica.",
                "El estr√©s del trabajo o de la calle me estimula y mantiene vivo.",
                "Me basto yo solo para resolver mis problemas.",
                "Si alguien me decepciona, prefiero 'romper' cuanto antes esa relaci√≥n.",
                "Me agrada pasar una tarde viendo programas de informaci√≥n cultural.",
                "Evito dar una buena idea a otro porque se aprovechar√° de ella.",
                "Los grandes fracasos afectan a mi estado de √°nimo.",
                "Mis familiares y amigos me tratan bien.",
                "Me gusta ser tratado como persona de cierta importancia.",
                "Dedico parte de mi tiempo libre a mejorar profesionalmente.",
                "Creo que alguien logra que haga cosas mediante sugesti√≥n o alg√∫n poder mental.",
                "Me siento inseguro en mis relaciones con los dem√°s.",
                "Cuando hay problemas me ofrezco para solucionarlos.",
                "El entusiasmo me ayuda a sentirme seguro.",
                "Tengo plena confianza en la capacidad de mis compa√±eros.",
                "Soy capaz de realizar varias tareas a la vez.",
                "Procuro descargarme con quien me enfada con sus tonter√≠as.",
                "Mis amigos me conf√≠an sus temores y preocupaciones.",
                "Me resulta f√°cil hacer nuevas amistades.",
                "Soy tolerante con quienes no respetan las normas.",
                "Me encuentro a gusto en entornos multirraciales.",
                "Mantengo la calma en la mayor√≠a de las situaciones.",
                "Me siento atra√≠do por las situaciones nuevas e inesperadas.",
                "Los obst√°culos y dificultades hacen que me supere para vencerlos.",
                "A la hora de tomar una decisi√≥n lo pienso con calma y sin alterarme.",
                "Creo poco en mi val√≠a personal.",
                "Los problemas demasiado dif√≠ciles me agobian y desaniman.",
                "He tenido la impresi√≥n de que me estaban vigilando sin que yo supiera por qu√©.",
                "Cambiar√≠a la mayor√≠a de las normas y reglas sociales establecidas.",
                "La mayor√≠a de las cosas me dejan preocupado.",
                "Me molesta que alguien use mis cosas sin pedirme permiso.",
                "En las reuniones sociales tengo don de gentes.",
                "Para poder rendir en mi trabajo necesito hacer pausas frecuentes.",
                "Tomo parte activa en los asuntos del grupo.",
                "Me resulta dif√≠cil entablar conversaci√≥n con extra√±os.",
                "Los dem√°s me hieren con sus cr√≠ticas y juicios personales.",
                "Se me puede hacer cambiar de opini√≥n.",
                "Tiendo a criticar en exceso a los dem√°s.",
                "Pierdo f√°cilmente la paciencia cuando trato con los dem√°s.",
                "Cuando las cosas salen mal espero que otros las resuelvan.",
                "En mi tiempo libre practico alg√∫n deporte.",
                "Cuando viajo, me intereso por las costumbres y estilo de vida del lugar al que voy.",
                "Me molesta cuando alg√∫n imprevisto irrumpe en mi vida cotidiana.",
                "Conf√≠o m√°s en m√≠ que en los dem√°s.",
                "Me siento m√°s capaz de hacer cosas que antes.",
                "Cuando mi jefe comete una injusticia conmigo trabajo a desgana.",
                "Me siento libre de pensamientos raros o extravagantes.",
                "Cuando me propongo algo pongo los medios adecuados para conseguirlo.",
                "Puedo seguir actuando con bastante normalidad cuando hay retos y tensiones en mi vida.",
                "Antes de actuar me paro a pensar en lo que los dem√°s piensen de m√≠.",
                "Me comporto igual entre amigos que en p√∫blico.",
                "Soy tan feliz como la mayor√≠a de las personas.",
                "Tengo la impresi√≥n de que la gente tiene mal concepto de m√≠.",
                "Cuando la situaci√≥n me pone tensa, mi cuerpo tambi√©n se tensa y parece que voy a estallar.",
                "Me resulta f√°cil hacer entrar en raz√≥n a los dem√°s.",
                "Cuando me topo con grandes obst√°culos, prefiero buscar metas m√°s asequibles.",
                "Me gusta el riesgo y la aventura.",
                "Prefiero la lectura y la contemplaci√≥n a la actividad y el deporte.",
                "Me gusta que se me reconozcan mis √©xitos profesionales.",
                "Por las noches suelo dormir de modo regular y tranquilo.",
                "Si tuviera la oportunidad aprender√≠a ruso.",
                "Me molesta cuando alguien me pide ayuda para algo que podr√≠a hacer solo.",
                "Me molesta y perturba tener que hablar a un grupo (como en una reuni√≥n social).",
                "Mantengo la calma en situaciones tensas.",
                "Me molesta estar inactivo y no tener nada que hacer.",
                "Me molesta estar mucho tiempo haciendo lo mismo.",
                "Me gustar√≠a ser tan feliz como parecen los dem√°s.",
                "Me afectan poco los problemas de mi vida cotidiana.",
                "Disfruto organizando y participando en actividades sociales.",
                "Trabajo mejor solo que con otros compa√±eros."
            ];

            // Variables globales para el control del test
            let currentQuestion = 0;  // Pregunta actual
            const answers = {};       // Almacena las respuestas del usuario
            let resultsChart = null;  // Referencia al gr√°fico de resultados

            // Definici√≥n de escalas y sus propiedades
            const scales = {
                sinceridad: {
                    name: "Sinceridad",
                    validRange: { min: 17, max: 22 },
                    directas: { A: 0, B: 1, C: 2, D: 3 },
                    inversas: { A: 3, B: 2, C: 1, D: 0 },
                    items: {
                        directas: [49, 57, 97, 99, 136, 149],
                        inversas: [12, 18, 71, 141],
                    }
                },

                desajuste: {
                    name: "Desajuste",
                    validRange: { min: 0, max: 2 },
                    directas: { A: 0, B: 1, C: 2, D: 3 },
                    inversas: { A: 3, B: 2, C: 1, D: 0 },
                    items: {
                        directas: [5, 15, 36, 96, 101, 118, 143],
                        inversas: [20, 98, 137],
                    }
                },
                ansiedad: {
                    name: "Ansiedad",
                    validRange: { min: 0, max: 5 },
                    directas: { A: 0, B: 1, C: 2, D: 3 },
                    inversas: { A: 3, B: 2, C: 1, D: 0 },
                    items: {
                        directas: [22, 47, 75, 129, 153],
                        inversas: [37, 62, 112, 115, 158],
                    }
                },
                depresion: {
                    name: "Depresi√≥n",
                    validRange: { min: 0, max: 5 },
                    directas: { A: 0, B: 1, C: 2, D: 3 },
                    inversas: { A: 3, B: 2, C: 1, D: 0 },
                    items: {
                        directas: [7, 43, 116, 120, 157],
                        inversas: [54, 104, 135, 142, 150],
                    }
                },
                toleranciaFlexibilidad: {
                    name: "Tolerancia Flexibilidad",
                    directas: { A: 0, B: 1, C: 2, D: 3 },
                    inversas: { A: 3, B: 2, C: 1, D: 0 },
                    validRange: { min: 19, max: 22 },
                    items: {
                        directas: [65, 110, 127],
                        inversas: [30, 44, 56, 68, 76, 94, 121],
                    }
                },

                toleranciaEstres: {
                    name: "Tolerancia al Estr√©s",
                    minScore: 22,
                    directas: { A: 0, B: 1, C: 2, D: 3 },
                    inversas: { A: 3, B: 2, C: 1, D: 0 },
                    items: {
                        directas: [1, 87, 92, 139, 154],
                        inversas: [14, 42, 46, 107, 144]
                    }
                },
                autoConcepto: {
                    name: "Auto Concepto",
                    minScore: 24,
                    directas: { A: 0, B: 1, C: 2, D: 3 },
                    inversas: { A: 3, B: 2, C: 1, D: 0 },
                    items: {
                        directas: [17, 38, 90, 93, 134],
                        inversas: [50, 66, 73, 126, 140]
                    }
                },
                adaptacionCambio: {
                    name: "Adaptaci√≥n al Cambio",
                    validRange: { min: 18, max: 23 },
                    directas: { A: 0, B: 1, C: 2, D: 3 },
                    inversas: { A: 3, B: 2, C: 1, D: 0 },
                    items: {
                        directas: [13, 33, 113, 147],
                        inversas: [6, 41, 59, 91, 133],
                    }
                },
                disponibilidad: {
                    name: "Disponibilidad",
                    minScore: 21,
                    directas: { A: 0, B: 1, C: 2, D: 3 },
                    inversas: { A: 3, B: 2, C: 1, D: 0 },
                    items: {
                        directas: [24, 63, 85, 103, 108],
                        inversas: [4, 21, 48, 130, 152]
                    }
                },
                integracionSocial: {
                    name: "Integraci√≥n Social",
                    minScore: 25,
                    directas: { A: 0, B: 1, C: 2, D: 3 },
                    inversas: { A: 3, B: 2, C: 1, D: 0 },
                    items: {
                        directas: [31, 53, 74, 83, 159],
                        inversas: [2, 16, 25, 35, 119]
                    }
                },
                tesonConstancia: {
                    name: "Tes√≥n/Constancia",
                    minScore: 26,
                    directas: { A: 0, B: 1, C: 2, D: 3 },
                    inversas: { A: 3, B: 2, C: 1, D: 0 },
                    items: {
                        directas: [28, 45, 69, 77, 138],
                        inversas: [10, 61, 84, 146, 156]
                    }
                },
                trabajoEquipo: {
                    name: "Trabajo en Equipo",
                    minScore: 27,
                    directas: { A: 0, B: 1, C: 2, D: 3 },
                    inversas: { A: 3, B: 2, C: 1, D: 0 },
                    items: {
                        directas: [29, 34, 60, 67, 105, 124],
                        inversas: [23, 82, 128, 160]
                    }
                },
                inteligenciaSocial: {
                    name: "Inteligencia Social",
                    minScore: 23,
                    directas: { A: 0, B: 1, C: 2, D: 3 },
                    inversas: { A: 3, B: 2, C: 1, D: 0 },
                    items: {
                        directas: [9, 26, 70, 109, 122, 145],
                        inversas: [39, 89, 102, 125]
                    }
                },
                autoexigenciaPersonal: {
                    name: "Autoexigencia Personal",
                    minScore: 26,
                    directas: { A: 0, B: 1, C: 2, D: 3 },
                    inversas: { A: 3, B: 2, C: 1, D: 0 },
                    items: {
                        directas: [19, 40, 55, 78, 100, 114],
                        inversas: [52, 58, 64, 117]
                    }
                },
                interesOtrasculturas: {
                    name: "Inter√©s en Otras Culturas",
                    minScore: 26,
                    directas: { A: 0, B: 1, C: 2, D: 3 },
                    inversas: { A: 3, B: 2, C: 1, D: 0 },
                    items: {
                        directas: [3, 11, 81, 88, 95, 111, 132, 151],
                        inversas: [8, 86]
                    }
                },

                dinamismo: {
                    name: "Dinamismo/Actividad",
                    minScore: 22,
                    directas: { A: 0, B: 1, C: 2, D: 3 },
                    inversas: { A: 3, B: 2, C: 1, D: 0 },
                    items: {
                        directas: [51, 72, 80, 106, 131, 155],
                        inversas: [27, 32, 123, 148]
                    }
                }
            };

            // Funciones principales del test
            // ====== MODO ENTRENAMIENTO ======

            let currentTrainingScale = null;
            let currentTrainingQuestion = 0;
            let trainingAnswers = {};

            function startTrainingMode() {
                document.getElementById("introPage").style.display = "none";
                document.getElementById("trainingPage").style.display = "block";
            }

            function selectTrainingScale(scaleKey) {
                currentTrainingScale = scaleKey;
                currentTrainingQuestion = 0;
                trainingAnswers = {};
                document.getElementById("scaleSelector").style.display = "none";
                document.getElementById("trainingResultsPage").style.display = "none";
                document.getElementById("trainingQuestionPage").style.display = "block";
                showTrainingQuestion();
            }

            function showTrainingQuestion() {
                const scale = scales[currentTrainingScale];
                const items = [...(scale.items.directas || []), ...(scale.items.inversas || [])];
                const questionIndex = items[currentTrainingQuestion] - 1;

                document.getElementById("trainingQuestionNumber").textContent = `Pregunta ${currentTrainingQuestion + 1} de ${items.length}`;
                document.getElementById("trainingQuestionText").textContent = questions[questionIndex];

                const optionsContainer = document.getElementById("trainingOptionsContainer");
                optionsContainer.innerHTML = "";

                ["A", "B", "C", "D"].forEach(letter => {
                    const btn = document.createElement("button");
                    btn.className = "option-button";
                    btn.textContent = `${letter}. ${getOptionLabel(letter)}`;
                    btn.onclick = () => selectTrainingOption(letter);
                    optionsContainer.appendChild(btn);
                });

                document.getElementById("trainingProgressFill").style.width = `${((currentTrainingQuestion + 1) / items.length) * 100}%`;
                document.getElementById("trainingNextButton").disabled = true;
            }

            function selectTrainingOption(letter) {
                const buttons = document.querySelectorAll('#trainingOptionsContainer .option-button');
                buttons.forEach(btn => btn.classList.remove('selected'));
                buttons.forEach(btn => {
                    if (btn.textContent.startsWith(letter)) btn.classList.add('selected');
                });

                const items = [...(scales[currentTrainingScale].items.directas || []), ...(scales[currentTrainingScale].items.inversas || [])];
                trainingAnswers[items[currentTrainingQuestion]] = letter;
                document.getElementById("trainingNextButton").disabled = false;
            }

            function nextTrainingQuestion() {
                const scale = scales[currentTrainingScale];
                const items = [...(scale.items.directas || []), ...(scale.items.inversas || [])];
                if (currentTrainingQuestion < items.length - 1) {
                    currentTrainingQuestion++;
                    showTrainingQuestion();
                } else {
                    showTrainingResults();
                }
            }

            function showTrainingResults() {
                const scale = scales[currentTrainingScale];
                const directas = scale.directas;
                const inversas = scale.inversas;
                let score = 0;

                (scale.items.directas || []).forEach(q => {
                    if (trainingAnswers[q]) score += directas[trainingAnswers[q]] ?? 0;
                });

                (scale.items.inversas || []).forEach(q => {
                    if (trainingAnswers[q]) score += inversas[trainingAnswers[q]] ?? 0;
                });

                const apto = scale.validRange
                    ? score >= scale.validRange.min && score <= scale.validRange.max
                    : score >= scale.minScore;

                const container = document.getElementById("trainingResultsContainer");
                container.innerHTML = `
    <div class="result-item">
      <div class="scale-header">
        <span class="scale-name">${scale.name}</span>
        <span class="status-badge ${apto ? 'apt' : 'not-apt'}">${apto ? 'APTO' : 'NO APTO'}</span>
      </div>
      <div class="score-info">
        <div><strong>Puntuaci√≥n:</strong> ${score}</div>
        ${scale.validRange
                        ? `<div><strong>Esperado:</strong> ${scale.validRange.min} a ${scale.validRange.max}</div>`
                        : `<div><strong>M√≠nimo esperado:</strong> ${scale.minScore}</div>`
                    }
      </div>
    </div>
  `;

                document.getElementById("trainingQuestionPage").style.display = "none";
                document.getElementById("trainingResultsPage").style.display = "block";
            }

            function backToScaleSelection() {
                document.getElementById("trainingQuestionPage").style.display = "none";
                document.getElementById("trainingResultsPage").style.display = "none";
                document.getElementById("scaleSelector").style.display = "block";
                currentTrainingScale = null;
                currentTrainingQuestion = 0;
                trainingAnswers = {};
            }

            function getOptionLabel(letter) {
                switch (letter) {
                    case 'A': return 'casi nunca';
                    case 'B': return 'a veces';
                    case 'C': return 'con frecuencia';
                    case 'D': return 'casi siempre';
                    default: return '';
                }
            }

            // Funci√≥n para iniciar el test
            function startTest() {
                document.getElementById('introPage').style.display = 'none';
                document.getElementById('questionPage').style.display = 'block';
                showQuestion();
            }

            // Funci√≥n para mostrar una pregunta
            function showQuestion() {
                const questionNumber = document.getElementById('questionNumber');
                const questionText = document.getElementById('questionText');
                const nextButton = document.querySelector('.next-button');
                const progressFill = document.getElementById('progressFill');

                // Actualizar n√∫mero y texto de la pregunta actual
                questionNumber.textContent = `Pregunta ${currentQuestion + 1} de ${questions.length}`;
                questionText.textContent = questions[currentQuestion];

                // Actualizar la barra de progreso
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                progressFill.style.width = `${progress}%`;

                // Resetear los botones de opci√≥n
                const options = document.querySelectorAll('.option-button');
                options.forEach(button => button.classList.remove('selected'));
                nextButton.disabled = true;

                // Si hay una respuesta previa, seleccionarla
                if (answers[currentQuestion + 1]) {
                    const selectedButton = Array.from(options).find(
                        button => button.textContent.startsWith(answers[currentQuestion + 1])
                    );
                    if (selectedButton) {
                        selectedButton.classList.add('selected');
                        nextButton.disabled = false;
                    }
                }
            }

            // Funci√≥n para seleccionar una opci√≥n de respuesta
            function selectOption(option) {
                // Limpiar selecci√≥n previa
                const buttons = document.querySelectorAll('.option-button');
                buttons.forEach(button => button.classList.remove('selected'));

                // Seleccionar nuevo bot√≥n
                const selectedButton = Array.from(buttons).find(
                    button => button.textContent.startsWith(option)
                );
                if (selectedButton) {
                    selectedButton.classList.add('selected');
                }

                // Guardar la respuesta
                answers[currentQuestion + 1] = option;

                // Habilitar el bot√≥n siguiente
                const nextButton = document.querySelector('.next-button');
                if (nextButton) {
                    nextButton.disabled = false;
                }
            }

            // Funci√≥n para avanzar a la siguiente pregunta
            function nextQuestion() {
                if (currentQuestion < questions.length - 1) {
                    currentQuestion++;
                    showQuestion();
                } else {
                    showResults();
                }
            }
            // Funci√≥n para calcular las puntuaciones de todas las escalas
            function calculateScores() {
                const results = {};

                // Recorremos todas las escalas definidas
                Object.entries(scales).forEach(([scaleKey, scale]) => {
                    let score = 0;

                    // Calcular puntuaci√≥n para √≠tems directos
                    scale.items.directas.forEach(item => {
                        if (answers[item]) {
                            score += scale.directas[answers[item]] || 0;
                        }
                    });

                    // Calcular puntuaci√≥n para √≠tems inversos
                    scale.items.inversas.forEach(item => {
                        if (answers[item]) {
                            score += scale.inversas[answers[item]] || 0;
                        }
                    });

                    // Determinar si es apto seg√∫n el tipo de evaluaci√≥n
                    let isApt = false;
                    if (scale.validRange) {
                        isApt = score >= scale.validRange.min && score <= scale.validRange.max;
                    } else if (scale.minScore) {
                        isApt = score >= scale.minScore;
                    }

                    // Guardar resultados de la escala
                    results[scaleKey] = {
                        score,
                        name: scale.name,
                        validRange: scale.validRange,
                        minScore: scale.minScore,
                        isApt,
                        items: scale.items
                    };
                });

                // Devolver resultados y aptitud general
                return {
                    scales: results,
                    generalAptitude: Object.values(results).every(result => result.isApt)
                };
            }

            // Funci√≥n auxiliar para obtener el texto de la respuesta
            function getAnswerText(answer) {
                const answerTexts = {
                    'A': 'Casi nunca',
                    'B': 'A veces',
                    'C': 'Con frecuencia',
                    'D': 'Casi siempre'
                };
                return answerTexts[answer] || 'Sin respuesta';
            }

            // Funci√≥n para identificar las escalas afectadas por cada pregunta
            function getAffectedScales(questionNumber) {
                const affectedScales = [];
                Object.entries(scales).forEach(([key, scale]) => {
                    if (scale.items.directas.includes(questionNumber)) {
                        affectedScales.push(`${scale.name} (Directa)`);
                    }
                    if (scale.items.inversas.includes(questionNumber)) {
                        affectedScales.push(`${scale.name} (Inversa)`);
                    }
                });
                return affectedScales.join(', ') || 'Ninguna';
            }

            // Reemplaza la funci√≥n showResults() existente con esta nueva versi√≥n
            function showResults() {
                document.getElementById('questionPage').style.display = 'none';
                document.getElementById('resultsPage').style.display = 'block';

                const scores = calculateScores();
                const resultsContainer = document.getElementById('resultsContainer');

                // Mostrar resultado general
                let html = `
        <h2>Resultados del Test</h2>
        <div class="scale-result">
            <h3>Resumen General</h3>
            <div style="margin-bottom: 10px;">
                <strong>Estado: </strong>
                <span style="color: ${scores.generalAptitude ? 'green' : 'red'}; font-weight: bold;">
                    ${scores.generalAptitude ? 'APTO' : 'NO APTO'}
                </span>
            </div>
        </div>
    `;

                // Mostrar resultados de cada escala
                Object.entries(scores.scales).forEach(([key, scale]) => {
                    const validRangeText = scale.validRange
                        ? `Entre ${scale.validRange.min} y ${scale.validRange.max}`
                        : `Mayor a ${scale.minScore}`;

                    let responsesHTML = `
            <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                <thead>
                    <tr style="background-color: #f0f0f0;">
                        <th style="padding: 8px; border: 1px solid #ddd; text-align: center;">N¬∫ Pregunta</th>
                        <th style="padding: 8px; border: 1px solid #ddd; text-align: left;">Pregunta</th>
                        <th style="padding: 8px; border: 1px solid #ddd; text-align: center;">Respuesta</th>
                        <th style="padding: 8px; border: 1px solid #ddd; text-align: center;">Puntos</th>
                    </tr>
                </thead>
                <tbody>
        `;

                    // Agregar √≠tems directos
                    scale.items.directas.forEach(itemNum => {
                        const response = answers[itemNum];
                        const points = response ? scales[key].directas[response] : 0;
                        responsesHTML += `
                <tr>
                    <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">${itemNum}</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">${questions[itemNum - 1]}</td>
                    <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">${getAnswerText(response)}</td>
                    <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">${points}</td>
                </tr>
            `;
                    });

                    // Agregar √≠tems inversos
                    scale.items.inversas.forEach(itemNum => {
                        const response = answers[itemNum];
                        const points = response ? scales[key].inversas[response] : 0;
                        responsesHTML += `
                <tr>
                    <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">${itemNum}</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">${questions[itemNum - 1]}</td>
                    <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">${getAnswerText(response)}</td>
                    <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">${points}</td>
                </tr>
            `;
                    });

                    responsesHTML += `
                </tbody>
                <tfoot>
                    <tr style="background-color: ${scale.isApt ? '#e6ffe6' : '#ffe6e6'};">
                        <td colspan="3" style="padding: 8px; border: 1px solid #ddd; text-align: right;"><strong>Puntuaci√≥n Total:</strong></td>
                        <td style="padding: 8px; border: 1px solid #ddd; text-align: center;"><strong>${scale.score}</strong></td>
                    </tr>
                </tfoot>
            </table>
        `;

                    html += `
            <div class="scale-result">
                <div class="scale-header">
                    <span class="scale-name">${scale.name}</span>
                    <span class="scale-score" style="color: ${scale.isApt ? 'green' : 'red'}">
                        Puntuaci√≥n: ${scale.score}
                    </span>
                </div>
                <div class="scale-status ${scale.isApt ? 'valid' : 'invalid'}">
                    ${scale.isApt ? 'DENTRO DEL RANGO' : 'FUERA DEL RANGO'}
                </div>
                <div class="scale-details">
                    <p>Rango esperado: ${validRangeText}</p>
                    <div style="margin-top: 10px;">
                        <strong>Detalle de respuestas:</strong>
                        ${responsesHTML}
                    </div>
                </div>
            </div>
        `;
                });

                resultsContainer.innerHTML = html;
            }

            // Funci√≥n auxiliar para obtener el texto de la respuesta
            function getAnswerText(answer) {
                const answerTexts = {
                    'A': 'Casi nunca',
                    'B': 'A veces',
                    'C': 'Con frecuencia',
                    'D': 'Casi siempre'
                };
                return answerTexts[answer] || 'Sin respuesta';
            }

            // Crear gr√°fico con los nuevos colores
            resultsChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: chartData.map(d => d.name),
                    datasets: [{
                        label: 'Puntuaci√≥n obtenida',
                        data: chartData.map(d => d.score),
                        backgroundColor: chartData.map(d => d.color),
                        borderColor: chartData.map(d => d.color),
                        borderWidth: 1,
                        barPercentage: 0.8
                    }, {
                        label: 'M√≠nimo requerido/Rango v√°lido',
                        data: chartData.map(d => d.validRange ? d.validRange.min : d.minScore),
                        type: 'line',
                        borderColor: '#2196F3',
                        borderDash: [5, 5],
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            grid: {
                                color: '#e0e0e0'
                            },
                            title: {
                                display: true,
                                text: 'Puntuaci√≥n'
                            }
                        },
                        y: {
                            grid: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                afterBody: function (context) {
                                    const index = context[0].dataIndex;
                                    const scale = Object.values(scores.scales)[index];
                                    const items = scale.items || {};
                                    return [
                                        '',
                                        'Detalles:',
                                        `√çtems directos: ${items.directas?.join(', ') || 'N/A'}`,
                                        `√çtems inversos: ${items.inversas?.join(', ') || 'N/A'}`,
                                        scale.validRange
                                            ? `Rango v√°lido: ${scale.validRange.min}-${scale.validRange.max}`
                                            : `Puntuaci√≥n m√≠nima: ${scale.minScore}`
                                    ];
                                }
                            }
                        }
                    }
                }
            });

            // Mostrar resultados detallados por escala
            const scaleResults = document.getElementById('scaleResults');
            scaleResults.innerHTML = '<h2 class="text-xl font-bold mb-4">Resultados detallados por factor</h2>';

            // Crear las tarjetas de resultado para cada escala
            Object.values(scores.scales).forEach(scale => {
                const div = document.createElement('div');
                div.className = 'result-item';

                // Calcular el percentil
                const maxPossibleScore = (scale.items.directas.length + scale.items.inversas.length) * 3;
                const percentil = Math.round((scale.score / maxPossibleScore) * 100);

                const requirement = scale.validRange
                    ? `Rango v√°lido: ${scale.validRange.min}-${scale.validRange.max}`
                    : `M√≠nimo requerido: ${scale.minScore}`;

                div.innerHTML = `
                    <div class="scale-header">
                        <h3 class="scale-name">${scale.name}</h3>
                        <span class="status-badge ${scale.isApt ? 'apt' : 'not-apt'}">
                            ${scale.isApt ? 'APTO' : 'NO APTO'}
                        </span>
                    </div>
                    <div class="scale-details">
                        <div class="score-info">
                            <p>Puntuaci√≥n: <strong>${scale.score}</strong></p>
                            <p>${requirement}</p>
                            <p>Percentil: <strong>${percentil}%</strong></p>
                        </div>
                        <div class="items-info">
                            <p><strong>√çtems directos (${scale.items.directas.length}):</strong> ${scale.items.directas.join(', ')}</p>
                            <p><strong>√çtems inversos (${scale.items.inversas.length}):</strong> ${scale.items.inversas.join(', ')}</p>
                        </div>
                        <div class="percentil-bar">
                            <div class="percentil-fill" style="width: ${percentil}%"></div>
                        </div>
                    </div>
                `;
                scaleResults.appendChild(div);
            });

            // Mostrar tabla de revisi√≥n de respuestas
            const answersTable = document.getElementById('answersTable');
            answersTable.innerHTML = `
                <table class="w-full mt-4 border-collapse">
                    <thead>
                        <tr>
                            <th class="border p-2">N¬∫</th>
                            <th class="border p-2">Pregunta</th>
                            <th class="border p-2">Respuesta</th>
                            <th class="border p-2">Escalas Afectadas</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${questions.map((question, index) => {
                const questionNumber = index + 1;
                const answer = answers[questionNumber];
                const affectedScales = getAffectedScales(questionNumber);

                return `
                                <tr>
                                    <td class="border p-2">${questionNumber}</td>
                                    <td class="border p-2">${question}</td>
                                    <td class="border p-2">${getAnswerText(answer)}</td>
                                    <td class="border p-2">${affectedScales}</td>
                                </tr>
                            `;
            }).join('')}
                    </tbody>
                </table>
            `;


            // Inicializar el test cuando se carga la p√°gina
            document.addEventListener('DOMContentLoaded', () => {
                showQuestion();
            });
        </script>
</body>

</html>